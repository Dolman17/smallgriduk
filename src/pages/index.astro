---
import BaseLayout from "../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";

const guidesAll = await getCollection("guides", ({ data }) => !data.draft);
const guides = guidesAll.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());
const featured = guides.slice(0, 6);
---

<BaseLayout
  title="Small, efficient homelabs"
  description="Low-power Jellyfin servers, mini PC homelabs, simple networking, and backups that actually restore."
  canonicalPath="/"
>
  <section class="card">
    <div class="kicker">âš¡ SmallGrid philosophy</div>
    <h1>Homelabs that donâ€™t become a second job.</h1>
    <p>
      Build quiet, low-power home servers that work reliably â€” Jellyfin, mini PCs, simple networking, and
      backups you can actually restore. No enterprise cosplay. Just sane defaults.
    </p>

    <div style="display:flex; gap:10px; flex-wrap:wrap; margin-top: 10px;">
      <a class="btn primary" href="/guides/">Browse guides</a>
      <a class="btn" href="/guides/jellyfin-ubuntu-low-power/">Start with Jellyfin</a>
      <a class="btn" href="/guides/mini-pc-under-200/">Mini PC under Â£200</a>
    </div>
  </section>

  <section style="margin-top: 16px;">
    <div style="display:flex; align-items:end; justify-content:space-between; gap: 12px; flex-wrap:wrap;">
      <h2>Latest guides</h2>
      <a class="btn" href="/guides/">View all â†’</a>
    </div>

    <div class="grid" style="margin-top: 10px;">
      {featured.map((post) => (
        <article class="card hover">
          <h3 style="margin-top: 0;">
            <a href={`/guides/${post.slug}/`}>{post.data.title}</a>
          </h3>
          <p>{post.data.description}</p>
          <div>
            {post.data.tags.slice(0, 4).map((t) => (
              <span class="pill">#{t}</span>
            ))}
          </div>
        </article>
      ))}
    </div>
  </section>

  <section class="grid" style="margin-top: 16px;">
    <div class="card">
      <div class="kicker">ğŸ”Œ Low power</div>
      <h2>Efficiency first</h2>
      <p>Mini PCs, iGPU transcoding, and â€œgood enoughâ€ choices that keep wattage and noise down.</p>
    </div>
    <div class="card">
      <div class="kicker">ğŸ§° Low drama</div>
      <h2>Maintainable</h2>
      <p>Setups you can support when youâ€™re busy, tired, or both. Fewer moving parts, fewer surprises.</p>
    </div>
    <div class="card">
      <div class="kicker">ğŸ›¡ï¸ Secure default</div>
      <h2>Tailscale over port-forwarding</h2>
      <p>Remote access that isnâ€™t â€œopen ports and prayâ€. Private networking that just works.</p>
    </div>
  </section>
</BaseLayout>
